import{f as m,c as L,b as D,v as F,d as R,e as X,g as Y,k as $,n as b,l as U,o as V,s as G,q as K,r as p,t as j,w as E,x as y}from"./index-C7pTNP2A.js";function z(e,t){let r;const s=()=>{const{currentTime:n}=t,c=(n===null?0:n.value)/100;r!==c&&e(c),r=c};return m.preUpdate(s,!0),()=>L(s)}const q=50,T=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),J=()=>({time:0,x:T(),y:T()}),_={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function H(e,t,r,s){const n=r[t],{length:l,position:c}=_[t],o=n.current,f=r.time;n.current=e[`scroll${c}`],n.scrollLength=e[`scroll${l}`]-e[`client${l}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=D(0,n.scrollLength,n.current);const i=s-f;n.velocity=i>q?0:F(n.current-o,i)}function Q(e,t,r){H(e,"x",t,r),H(e,"y",t,r),t.time=r}function Z(e,t){const r={x:0,y:0};let s=e;for(;s&&s!==t;)if(R(s))r.x+=s.offsetLeft,r.y+=s.offsetTop,s=s.offsetParent;else if(s.tagName==="svg"){const n=s.getBoundingClientRect();s=s.parentElement;const l=s.getBoundingClientRect();r.x+=n.left-l.left,r.y+=n.top-l.top}else if(s instanceof SVGGraphicsElement){const{x:n,y:l}=s.getBBox();r.x+=n,r.y+=l;let c=null,o=s.parentNode;for(;!c;)o.tagName==="svg"&&(c=o),o=s.parentNode;s=c}else break;return r}const W={start:0,center:.5,end:1};function k(e,t,r=0){let s=0;if(e in W&&(e=W[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?s=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?s=n/100*document.documentElement.clientWidth:e.endsWith("vh")?s=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(s=t*e),r+s}const ee=[0,0];function te(e,t,r,s){let n=Array.isArray(e)?e:ee,l=0,c=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,W[e]?e:"0"]),l=k(n[0],r,s),c=k(n[1],t),l-c}const se={All:[[0,0],[1,1]]},re={x:0,y:0};function ne(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function le(e,t,r){const{offset:s=se.All}=r,{target:n=e,axis:l="y"}=r,c=l==="y"?"height":"width",o=n!==e?Z(n,e):re,f=n===e?{width:e.scrollWidth,height:e.scrollHeight}:ne(n),i={width:e.clientWidth,height:e.clientHeight};t[l].offset.length=0;let u=!t[l].interpolate;const h=s.length;for(let a=0;a<h;a++){const d=te(s[a],i[c],f[c],o[l]);!u&&d!==t[l].interpolatorOffsets[a]&&(u=!0),t[l].offset[a]=d}u&&(t[l].interpolate=X(t[l].offset,Y(s),{clamp:!1}),t[l].interpolatorOffsets=[...t[l].offset]),t[l].progress=$(0,1,t[l].interpolate(t[l].current))}function ce(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let s=t;for(;s&&s!==e;)r.x.targetOffset+=s.offsetLeft,r.y.targetOffset+=s.offsetTop,s=s.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function oe(e,t,r,s={}){return{measure:n=>{ce(e,s.target,r),Q(e,r,n),(s.offset||s.target)&&le(e,r,s)},notify:()=>t(r)}}const g=new WeakMap,O=new WeakMap,x=new WeakMap,P=new WeakMap,v=new WeakMap,S=e=>e===document.scrollingElement?window:e;function M(e,{container:t=document.scrollingElement,trackContentSize:r=!1,...s}={}){if(!t)return b;let n=x.get(t);n||(n=new Set,x.set(t,n));const l=J(),c=oe(t,e,l,s);if(n.add(c),!g.has(t)){const f=()=>{for(const a of n)a.measure(V.timestamp);m.preUpdate(i)},i=()=>{for(const a of n)a.notify()},u=()=>m.read(f);g.set(t,u);const h=S(t);window.addEventListener("resize",u),t!==document.documentElement&&O.set(t,U(t,u)),h.addEventListener("scroll",u),u()}if(r&&!v.has(t)){const f=g.get(t),i={width:t.scrollWidth,height:t.scrollHeight};P.set(t,i);const u=()=>{const a=t.scrollWidth,d=t.scrollHeight;(i.width!==a||i.height!==d)&&(f(),i.width=a,i.height=d)},h=m.read(u,!0);v.set(t,h)}const o=g.get(t);return m.read(o,!1,!0),()=>{var h;L(o);const f=x.get(t);if(!f||(f.delete(c),f.size))return;const i=g.get(t);g.delete(t),i&&(S(t).removeEventListener("scroll",i),(h=O.get(t))==null||h(),window.removeEventListener("resize",i));const u=v.get(t);u&&(L(u),v.delete(t)),P.delete(t)}}function I(e){return typeof window<"u"&&!e&&G()}const C=new Map;function ie(e){const t={value:0},r=M(s=>{t.value=s[e.axis].progress*100},e);return{currentTime:t,cancel:r}}function A({source:e,container:t,...r}){const{axis:s}=r;e&&(t=e);const n=C.get(t)??new Map;C.set(t,n);const l=r.target??"self",c=n.get(l)??{},o=s+(r.offset??[]).join(",");return c[o]||(c[o]=I(r.target)?new ScrollTimeline({source:t,axis:s}):ie({container:t,...r})),c[o]}function fe(e,t){const r=A(t);return e.attachTimeline({timeline:t.target?void 0:r,observe:s=>(s.pause(),z(n=>{s.time=s.iterationDuration*n},r))})}function ue(e){return e.length===2}function ae(e,t){return ue(e)?M(r=>{e(r[t.axis].progress,r)},t):z(e,A(t))}function N(e,{axis:t="y",container:r=document.scrollingElement,...s}={}){if(!r)return b;const n={axis:t,container:r,...s};return typeof e=="function"?ae(e,n):fe(e,n)}const he=()=>({scrollX:y(0),scrollY:y(0),scrollXProgress:y(0),scrollYProgress:y(0)}),w=e=>e?!e.current:!1;function B(e,t,r){return{factory:s=>N(s,{...t,axis:e,container:r}),times:[0,1],keyframes:[0,1],ease:s=>s,duration:1}}function de({container:e,target:t,...r}={}){const s=K(he);if(!t&&I()){const o=(e==null?void 0:e.current)||void 0;s.scrollXProgress.accelerate=B("x",r,o),s.scrollYProgress.accelerate=B("y",r,o)}const n=p.useRef(null),l=p.useRef(!1),c=p.useCallback(()=>(n.current=N((o,{x:f,y:i})=>{s.scrollX.set(f.current),s.scrollXProgress.set(f.progress),s.scrollY.set(i.current),s.scrollYProgress.set(i.progress)},{...r,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0}),()=>{var o;(o=n.current)==null||o.call(n)}),[e,t,JSON.stringify(r.offset)]);return j(()=>{if(l.current=!1,w(e)||w(t)){l.current=!0;return}else return c()},[c]),p.useEffect(()=>{if(l.current)return E(!w(e)),E(!w(t)),c()},[c]),s}export{de as u};
